name: Update Live Status

on:
  push:
    paths:
      - status.json

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Install jq
        run: sudo apt-get update && sudo apt-get install -y jq

      - name: Generate SVG
        run: |
          CURRENT=$(jq -r .current status.json)
          LEARNING=$(jq -r .learning status.json)
          MOOD=$(jq -r .mood status.json)
          echo '<svg xmlns="http://www.w3.org/2000/svg" width="700" height="120">
          <style>
            .t { font: 16px monospace; fill: #ffffff }
            .bg { fill: #0d1117 }
          </style>
          <rect width="100%" height="100%" class="bg"/>
          <text x="20" y="35" class="t">ðŸŸ¢ Current: '"$CURRENT"'</text>
          <text x="20" y="65" class="t">ðŸŸ¡ Learning: '"$LEARNING"'</text>
          <text x="20" y="95" class="t">ðŸ”´ Mood: '"$MOOD"'</text>
          </svg>' > live-status.svg

      - name: Commit SVG
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add live-status.svg
          git commit -m "update live status" || echo "No changes to commit"
          git push
